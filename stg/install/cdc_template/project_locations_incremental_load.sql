insert into config.CDC_TEMPLATE (SOURCE_SCHEMA_NAME, SOURCE_OBJECT_NAME, TARGET_SCHEMA_NAME, TARGET_OBJECT_NAME, DEDUP_TABLE_NAME, FULL_LOAD, CREATE_DEDUP_TABLE_SQL, MERGE_TABLE_SQL,COLUMN_NAMES,S3_FOLDER_PATH,JSON_SCHEMA_PATH) values ('install_temp', 'temp_project_locations', 'install', 'project_locations', 'temp_project_locations_dedup', 'FALSE', 'create temporary table temp_project_locations_dedup as (select * from install_temp.temp_project_locations tb qualify row_number() over (partition by mapping_id order by MODIFIED_AT desc) = 1)', 'merge into install.project_locations using temp_project_locations_dedup TEMP_TBL on project_locations.mapping_id = TEMP_TBL.mapping_id when matched then update set project_id = TEMP_TBL.project_id,
site_id = TEMP_TBL.site_id,
installation_id = TEMP_TBL.installation_id,
company_id = TEMP_TBL.company_id,
account_id = TEMP_TBL.account_id,
mapping_id = TEMP_TBL.mapping_id,
event_retry_count = TEMP_TBL.event_retry_count,
event_triggered = TEMP_TBL.event_triggered,
event_retry_time = TEMP_TBL.event_retry_time,
is_deleted = TEMP_TBL.is_deleted,
created_by = TEMP_TBL.created_by,
created_at = TEMP_TBL.created_at,
modified_by = TEMP_TBL.modified_by,
modified_at = TEMP_TBL.modified_at,
correlation_id = TEMP_TBL.correlation_id,
kafka_topic = TEMP_TBL.kafka_topic,
kafka_partition = TEMP_TBL.kafka_partition,
kafka_offset = TEMP_TBL.kafka_offset,
kafka_timestamp = TEMP_TBL.kafka_timestamp,
kafka_timestamp_type = TEMP_TBL.kafka_timestamp_type,
kafka_datetime = TEMP_TBL.kafka_datetime,
kafka_key = TEMP_TBL.kafka_key,
etl_process_timestamp = TEMP_TBL.etl_process_timestamp,
etl_process_utc_ts = TEMP_TBL.etl_process_utc_ts,
record_update_ts=sysdate when not matched then insert (project_id, site_id, installation_id, company_id, account_id, mapping_id, event_retry_count, event_triggered, event_retry_time, is_deleted, created_by, created_at, modified_by, modified_at, correlation_id, kafka_topic, kafka_partition, kafka_offset, kafka_timestamp, kafka_timestamp_type, kafka_datetime, kafka_key, etl_process_timestamp, etl_process_utc_ts, RECORD_CREATION_TS, RECORD_UPDATE_TS) values (TEMP_TBL.project_id, TEMP_TBL.site_id, TEMP_TBL.installation_id, TEMP_TBL.company_id, TEMP_TBL.account_id, TEMP_TBL.mapping_id, TEMP_TBL.event_retry_count, TEMP_TBL.event_triggered, TEMP_TBL.event_retry_time, TEMP_TBL.is_deleted, TEMP_TBL.created_by, TEMP_TBL.created_at, TEMP_TBL.modified_by, TEMP_TBL.modified_at, TEMP_TBL.correlation_id, TEMP_TBL.kafka_topic, TEMP_TBL.kafka_partition, TEMP_TBL.kafka_offset, TEMP_TBL.kafka_timestamp, TEMP_TBL.kafka_timestamp_type, TEMP_TBL.kafka_datetime, TEMP_TBL.kafka_key, TEMP_TBL.etl_process_timestamp, TEMP_TBL.etl_process_utc_ts,sysdate,sysdate)','project_id, site_id, installation_id, company_id, account_id, mapping_id, event_retry_count, event_triggered, event_retry_time, is_deleted, created_by, created_at, modified_by, modified_at, correlation_id, kafka_topic, kafka_partition, kafka_offset, kafka_timestamp, kafka_timestamp_type, kafka_datetime, kafka_key, etl_process_timestamp, etl_process_utc_ts','s3://lytx-device-stg-oregon/install/install.projectLocations/stage/','NA');