insert into config.CDC_TEMPLATE (SOURCE_SCHEMA_NAME, SOURCE_OBJECT_NAME, TARGET_SCHEMA_NAME, TARGET_OBJECT_NAME, DEDUP_TABLE_NAME, FULL_LOAD, CREATE_DEDUP_TABLE_SQL, MERGE_TABLE_SQL,COLUMN_NAMES,S3_FOLDER_PATH,JSON_SCHEMA_PATH) values ('install_temp', 'temp_projects', 'install', 'projects', 'temp_projects_dedup', 'FALSE', 'create temporary table temp_projects_dedup as (select * from install_temp.temp_projects tb qualify row_number() over (partition by project_id order by MODIFIED_AT desc) = 1)', 'merge into install.projects using temp_projects_dedup TEMP_TBL on projects.project_id = TEMP_TBL.project_id when matched then update set project_id = TEMP_TBL.project_id,
quote_number = TEMP_TBL.quote_number,
oppty_abssd = TEMP_TBL.oppty_abssd,
oppty_bssd = TEMP_TBL.oppty_bssd,
booked_qty = TEMP_TBL.booked_qty,
oppty_po_number = TEMP_TBL.oppty_po_number,
install_type = TEMP_TBL.install_type,
number_of_devices = TEMP_TBL.number_of_devices,
project_name = TEMP_TBL.project_name,
vehicle_availability = TEMP_TBL.vehicle_availability,
company_id = TEMP_TBL.company_id,
account_id = TEMP_TBL.account_id,
salesforce_id = TEMP_TBL.salesforce_id,
install_status = TEMP_TBL.install_status,
principal_project_id = TEMP_TBL.principal_project_id,
oppty_install_type = TEMP_TBL.oppty_install_type,
install_manager = TEMP_TBL.install_manager,
install_manager_id = TEMP_TBL.install_manager_id,
event_retry_count = TEMP_TBL.event_retry_count,
event_triggered = TEMP_TBL.event_triggered,
event_retry_time = TEMP_TBL.event_retry_time,
is_deleted = TEMP_TBL.is_deleted,
install_manager_email = TEMP_TBL.install_manager_email,
created_by = TEMP_TBL.created_by,
created_at = TEMP_TBL.created_at,
modified_by = TEMP_TBL.modified_by,
modified_at = TEMP_TBL.modified_at,
correlation_id = TEMP_TBL.correlation_id,
kafka_topic = TEMP_TBL.kafka_topic,
kafka_partition = TEMP_TBL.kafka_partition,
kafka_offset = TEMP_TBL.kafka_offset,
kafka_timestamp = TEMP_TBL.kafka_timestamp,
kafka_timestamp_type = TEMP_TBL.kafka_timestamp_type,
kafka_datetime = TEMP_TBL.kafka_datetime,
kafka_key = TEMP_TBL.kafka_key,
etl_process_timestamp = TEMP_TBL.etl_process_timestamp,
etl_process_utc_ts = TEMP_TBL.etl_process_utc_ts,
record_update_ts=sysdate when not matched then insert (project_id, quote_number, oppty_abssd, oppty_bssd, booked_qty, oppty_po_number, install_type, number_of_devices, project_name, vehicle_availability, company_id, account_id, salesforce_id, install_status, principal_project_id, oppty_install_type, install_manager, install_manager_id, event_retry_count, event_triggered, event_retry_time, is_deleted, install_manager_email, created_by, created_at, modified_by, modified_at, correlation_id, kafka_topic, kafka_partition, kafka_offset, kafka_timestamp, kafka_timestamp_type, kafka_datetime, kafka_key, etl_process_timestamp, etl_process_utc_ts, RECORD_CREATION_TS, RECORD_UPDATE_TS) values (TEMP_TBL.project_id, TEMP_TBL.quote_number, TEMP_TBL.oppty_abssd, TEMP_TBL.oppty_bssd, TEMP_TBL.booked_qty, TEMP_TBL.oppty_po_number, TEMP_TBL.install_type, TEMP_TBL.number_of_devices, TEMP_TBL.project_name, TEMP_TBL.vehicle_availability, TEMP_TBL.company_id, TEMP_TBL.account_id, TEMP_TBL.salesforce_id, TEMP_TBL.install_status, TEMP_TBL.principal_project_id, TEMP_TBL.oppty_install_type, TEMP_TBL.install_manager, TEMP_TBL.install_manager_id, TEMP_TBL.event_retry_count, TEMP_TBL.event_triggered, TEMP_TBL.event_retry_time, TEMP_TBL.is_deleted, TEMP_TBL.install_manager_email, TEMP_TBL.created_by, TEMP_TBL.created_at, TEMP_TBL.modified_by, TEMP_TBL.modified_at, TEMP_TBL.correlation_id, TEMP_TBL.kafka_topic, TEMP_TBL.kafka_partition, TEMP_TBL.kafka_offset, TEMP_TBL.kafka_timestamp, TEMP_TBL.kafka_timestamp_type, TEMP_TBL.kafka_datetime, TEMP_TBL.kafka_key, TEMP_TBL.etl_process_timestamp, TEMP_TBL.etl_process_utc_ts,sysdate,sysdate)','project_id, quote_number, oppty_abssd, oppty_bssd, booked_qty, oppty_po_number, install_type, number_of_devices, project_name, vehicle_availability, company_id, account_id, salesforce_id, install_status, principal_project_id, oppty_install_type, install_manager, install_manager_id, event_retry_count, event_triggered, event_retry_time, is_deleted, install_manager_email, created_by, created_at, modified_by, modified_at, correlation_id, kafka_topic, kafka_partition, kafka_offset, kafka_timestamp, kafka_timestamp_type, kafka_datetime, kafka_key, etl_process_timestamp, etl_process_utc_ts','s3://lytx-device-stg-oregon/install/install.projects/stage/','NA');